{
  "name" : "CleanData",
  "jobMode" : "VISUAL",
  "description" : "",
  "role" : "arn:aws:iam::140023393644:role/service-role/AWSGlueServiceRole",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-140023393644-us-east-1/scripts/CleanData.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_common.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_split.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_array_to_cols.py",
    "--spark-event-logs-path" : "s3://aws-glue-assets-140023393644-us-east-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-observability-metrics" : "true",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-140023393644-us-east-1/temporary/"
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 480,
  "maxCapacity" : 10.0,
  "glueVersion" : "5.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "executionClass" : "STANDARD",
  "codeGenConfigurationNodes" : "{\"node-1736549068619\":{\"CatalogSource\":{\"Database\":\"gluecrawlerdb\",\"Name\":\"AWS Glue Data Catalog\",\"Table\":\"nequirawdata\"}},\"node-1736552051960\":{\"DynamicTransform\":{\"FunctionName\":\"gs_split\",\"Inputs\":[\"node-1736551985520\"],\"Name\":\"SplitLocalizacionEventoB\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"localizacioneventob\"]},{\"IsOptional\":false,\"Name\":\"pattern\",\"Type\":\"str\",\"Value\":[\",\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_split.py\",\"TransformName\":\"gs_split\",\"Version\":\"1.0.0\"}},\"node-1736551938940\":{\"DynamicTransform\":{\"FunctionName\":\"gs_split\",\"Inputs\":[\"node-1736549236931\"],\"Name\":\"SplitLocalizacionComercio\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"localizacioncomerciocredito\"]},{\"IsOptional\":false,\"Name\":\"pattern\",\"Type\":\"str\",\"Value\":[\",\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_split.py\",\"TransformName\":\"gs_split\",\"Version\":\"1.0.0\"}},\"node-1736552171295\":{\"ApplyMapping\":{\"Inputs\":[\"node-1736552072823\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"creditoid\"],\"FromType\":\"string\",\"ToKey\":\"creditoid\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"personaid\"],\"FromType\":\"string\",\"ToKey\":\"personaid\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"departamentoresidencia\"],\"FromType\":\"string\",\"ToKey\":\"departamentoresidencia\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"departamentomayorfrecuenciacompra\"],\"FromType\":\"string\",\"ToKey\":\"departamentomayorfrecuenciacompra\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"almacenmayorfrecuenciapago\"],\"FromType\":\"string\",\"ToKey\":\"almacenmayorfrecuenciapago\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"valorpagosultimosmes\"],\"FromType\":\"double\",\"ToKey\":\"valorpagosultimosmes\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"almacencredito\"],\"FromType\":\"string\",\"ToKey\":\"almacencredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"riesgoalmacen\"],\"FromType\":\"bigint\",\"ToKey\":\"riesgoalmacen\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"departamentocredito\"],\"FromType\":\"string\",\"ToKey\":\"departamentocredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"fechacredito\"],\"FromType\":\"timestamp\",\"ToKey\":\"fechacredito\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"valorcredito\"],\"FromType\":\"double\",\"ToKey\":\"valorcredito\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"cupototal\"],\"FromType\":\"double\",\"ToKey\":\"cupototal\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"cupodisponibletotal\"],\"FromType\":\"double\",\"ToKey\":\"cupodisponibletotal\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"storeideventoa\"],\"FromType\":\"string\",\"ToKey\":\"storeideventoa\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"fechaeventoa\"],\"FromType\":\"timestamp\",\"ToKey\":\"fechaeventoa\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"eventoa\"],\"FromType\":\"string\",\"ToKey\":\"eventoa\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"fechaeventob\"],\"FromType\":\"timestamp\",\"ToKey\":\"fechaeventob\",\"ToType\":\"timestamp\"},{\"Dropped\":true,\"FromPath\":[\"localizacioneventob\"],\"FromType\":\"array\",\"ToKey\":\"localizacioneventob\",\"ToType\":\"array\"},{\"Dropped\":true,\"FromPath\":[\"localizacioncomerciocredito\"],\"FromType\":\"array\",\"ToKey\":\"localizacioncomerciocredito\",\"ToType\":\"array\"},{\"Dropped\":false,\"FromPath\":[\"statuscomerciocredito\"],\"FromType\":\"string\",\"ToKey\":\"statuscomerciocredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"frecuenciacreditossemana\"],\"FromType\":\"double\",\"ToKey\":\"frecuenciacreditossemana\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"cantidadcreditosultimasemana\"],\"FromType\":\"bigint\",\"ToKey\":\"cantidadcreditosultimasemana\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"valoratipicocliente\"],\"FromType\":\"double\",\"ToKey\":\"valoratipicocliente\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"valoratipicocomercio\"],\"FromType\":\"double\",\"ToKey\":\"valoratipicocomercio\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"tipoalmacencredito\"],\"FromType\":\"string\",\"ToKey\":\"tipoalmacencredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"tipocliente\"],\"FromType\":\"string\",\"ToKey\":\"tipocliente\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"atipico\"],\"FromType\":\"bigint\",\"ToKey\":\"atipico\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"LatitudComercioCredito\"],\"FromType\":\"string\",\"ToKey\":\"LatitudComercioCredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"LongitudComercioCredito\"],\"FromType\":\"string\",\"ToKey\":\"LongitudComercioCredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"LatitudEventoB\"],\"FromType\":\"string\",\"ToKey\":\"LatitudEventoB\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"LongitudEventoB\"],\"FromType\":\"string\",\"ToKey\":\"LongitudEventoB\",\"ToType\":\"string\"}],\"Name\":\"Change Schema\"}},\"node-1736613632759\":{\"S3DirectTarget\":{\"AutoDataQuality\":{\"IsEnabled\":false},\"Compression\":\"none\",\"Format\":\"csv\",\"Inputs\":[\"node-1736613908831\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://raarangoqbucket/CleanData/\",\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false}}},\"node-1736549236931\":{\"ApplyMapping\":{\"Inputs\":[\"node-1736549068619\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"creditoid\"],\"FromType\":\"string\",\"ToKey\":\"creditoid\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"personaid\"],\"FromType\":\"string\",\"ToKey\":\"personaid\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"departamentoresidencia\"],\"FromType\":\"long\",\"ToKey\":\"departamentoresidencia\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"departamentomayorfrecuenciacompra\"],\"FromType\":\"long\",\"ToKey\":\"departamentomayorfrecuenciacompra\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"almacenmayorfrecuenciapago\"],\"FromType\":\"string\",\"ToKey\":\"almacenmayorfrecuenciapago\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"valorpagosultimosmes\"],\"FromType\":\"double\",\"ToKey\":\"valorpagosultimosmes\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"almacencredito\"],\"FromType\":\"string\",\"ToKey\":\"almacencredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"riesgoalmacen\"],\"FromType\":\"long\",\"ToKey\":\"riesgoalmacen\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"departamentocredito\"],\"FromType\":\"long\",\"ToKey\":\"departamentocredito\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"fechacredito\"],\"FromType\":\"string\",\"ToKey\":\"fechacredito\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"valorcredito\"],\"FromType\":\"double\",\"ToKey\":\"valorcredito\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"cupototal\"],\"FromType\":\"double\",\"ToKey\":\"cupototal\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"cupodisponibletotal\"],\"FromType\":\"double\",\"ToKey\":\"cupodisponibletotal\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"storeideventoa\"],\"FromType\":\"string\",\"ToKey\":\"storeideventoa\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"fechaeventoa\"],\"FromType\":\"string\",\"ToKey\":\"fechaeventoa\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"eventoa\"],\"FromType\":\"string\",\"ToKey\":\"eventoa\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"fechaeventob\"],\"FromType\":\"string\",\"ToKey\":\"fechaeventob\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"localizacioneventob\"],\"FromType\":\"string\",\"ToKey\":\"localizacioneventob\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"localizacioncomerciocredito\"],\"FromType\":\"string\",\"ToKey\":\"localizacioncomerciocredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"statuscomerciocredito\"],\"FromType\":\"double\",\"ToKey\":\"statuscomerciocredito\",\"ToType\":\"varchar\"},{\"Dropped\":false,\"FromPath\":[\"frecuenciacreditossemana\"],\"FromType\":\"double\",\"ToKey\":\"frecuenciacreditossemana\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"cantidadcreditosultimasemana\"],\"FromType\":\"long\",\"ToKey\":\"cantidadcreditosultimasemana\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"valoratipicocliente\"],\"FromType\":\"double\",\"ToKey\":\"valoratipicocliente\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"valoratipicocomercio\"],\"FromType\":\"double\",\"ToKey\":\"valoratipicocomercio\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"tipoalmacencredito\"],\"FromType\":\"string\",\"ToKey\":\"tipoalmacencredito\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"tipocliente\"],\"FromType\":\"string\",\"ToKey\":\"tipocliente\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"atipico\"],\"FromType\":\"long\",\"ToKey\":\"atipico\",\"ToType\":\"long\"}],\"Name\":\"CambiarTiposCategorias\"}},\"node-1736613908830\":{\"EvaluateDataQualityMultiFrame\":{\"AdditionalDataSources\":{},\"AdditionalOptions\":{\"performanceTuning.caching\":\"CACHE_NOTHING\"},\"Inputs\":[\"node-1736552171295\"],\"Name\":\"EvaluateDataQualityMultiFrame\",\"PublishingOptions\":{\"CloudWatchMetricsEnabled\":false,\"EvaluationContext\":\"EvaluateDataQuality_node1736613586154\",\"ResultsPublishingEnabled\":true,\"ResultsS3Prefix\":\"\"},\"Ruleset\":\"Rules = [\\n    # RowCount stays above 0\\n    RowCount > 0,\\n\\n    IsPrimaryKey \\\"creditoid\\\",\\n    ColumnDataType \\\"fechacredito\\\" = \\\"Date\\\",\\n    ColumnDataType \\\"fechaeventoa\\\" = \\\"Date\\\",\\n    ColumnDataType \\\"fechaeventob\\\" = \\\"Date\\\",\\n\\n    # ColumnCount does not drop\\n    ColumnCount >= max(last(1))\\n]\",\"StopJobOnFailureOptions\":{}}},\"node-1736551985520\":{\"DynamicTransform\":{\"FunctionName\":\"gs_array_to_cols\",\"Inputs\":[\"node-1736551938940\"],\"Name\":\"ArrayLatitudLongitudComercio\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"localizacioncomerciocredito\"]},{\"IsOptional\":false,\"Name\":\"colList\",\"Type\":\"str\",\"Value\":[\"LatitudComercioCredito,LongitudComercioCredito\"]},{\"IsOptional\":true,\"Name\":\"indexes\",\"Type\":\"str\",\"Value\":[\"1,2\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_array_to_cols.py\",\"TransformName\":\"gs_array_to_cols\",\"Version\":\"1.0.0\"}},\"node-1736613908831\":{\"SelectFromCollection\":{\"Index\":0,\"Inputs\":[\"node-1736613908830\"],\"Name\":\"originalData\"}},\"node-1736552072823\":{\"DynamicTransform\":{\"FunctionName\":\"gs_array_to_cols\",\"Inputs\":[\"node-1736552051960\"],\"Name\":\"ArrayLatitudLongitudEventoB\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"creditoid\",\"Type\":\"string\"},{\"Name\":\"personaid\",\"Type\":\"string\"},{\"Name\":\"departamentoresidencia\",\"Type\":\"string\"},{\"Name\":\"departamentomayorfrecuenciacompra\",\"Type\":\"string\"},{\"Name\":\"almacenmayorfrecuenciapago\",\"Type\":\"string\"},{\"Name\":\"valorpagosultimosmes\",\"Type\":\"double\"},{\"Name\":\"almacencredito\",\"Type\":\"string\"},{\"Name\":\"riesgoalmacen\",\"Type\":\"bigint\"},{\"Name\":\"departamentocredito\",\"Type\":\"string\"},{\"Name\":\"fechacredito\",\"Type\":\"timestamp\"},{\"Name\":\"valorcredito\",\"Type\":\"double\"},{\"Name\":\"cupototal\",\"Type\":\"double\"},{\"Name\":\"cupodisponibletotal\",\"Type\":\"double\"},{\"Name\":\"storeideventoa\",\"Type\":\"string\"},{\"Name\":\"fechaeventoa\",\"Type\":\"timestamp\"},{\"Name\":\"eventoa\",\"Type\":\"string\"},{\"Name\":\"fechaeventob\",\"Type\":\"timestamp\"},{\"Name\":\"localizacioneventob\",\"Type\":\"array<string>\"},{\"Name\":\"localizacioncomerciocredito\",\"Type\":\"array<string>\"},{\"Name\":\"statuscomerciocredito\",\"Type\":\"string\"},{\"Name\":\"frecuenciacreditossemana\",\"Type\":\"double\"},{\"Name\":\"cantidadcreditosultimasemana\",\"Type\":\"bigint\"},{\"Name\":\"valoratipicocliente\",\"Type\":\"double\"},{\"Name\":\"valoratipicocomercio\",\"Type\":\"double\"},{\"Name\":\"tipoalmacencredito\",\"Type\":\"string\"},{\"Name\":\"tipocliente\",\"Type\":\"string\"},{\"Name\":\"atipico\",\"Type\":\"bigint\"},{\"Name\":\"LatitudComercioCredito\",\"Type\":\"string\"},{\"Name\":\"LongitudComercioCredito\",\"Type\":\"string\"},{\"Name\":\"LatitudEventoB\",\"Type\":\"string\"},{\"Name\":\"LongitudEventoB\",\"Type\":\"string\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"localizacioneventob\"]},{\"IsOptional\":false,\"Name\":\"colList\",\"Type\":\"str\",\"Value\":[\"LatitudEventoB,LongitudEventoB\"]},{\"IsOptional\":true,\"Name\":\"indexes\",\"Type\":\"str\",\"Value\":[\"1,2\"]}],\"Path\":\"s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_array_to_cols.py\",\"TransformName\":\"gs_array_to_cols\",\"Version\":\"1.0.0\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "AWS-Glue-demo",
    "branch" : "main",
    "folder" : "CleanData"
  }
}